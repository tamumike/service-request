<div matSort class="RequestList" (matSortChange)="sortData($event)">
  <h1>Active Requests</h1>

  <div class="container m-2">
    <button class="btn btn-sm btn-dark mt-3" (click)="toggleFilterMode()">Filters</button>
    <form *ngIf="filterMode" [formGroup]="filterRequestsForm" (ngSubmit)="filterRequests()">
      <div class="row d-inline-flex align-items-center m-3">

        <label for="field">Field: </label>
        <div class="form-group m-2">

          <select
          (change)="checkFilterInputType()"
          formControlName="field"
          class="form-control">
            <option *ngFor="let field of fieldsForFilter" value="{{ field.value }}">{{ field.display }}</option>
          </select>
        </div>

        <label for="fieldValue">Value: </label>
        <div  class="form-group m-2">

          <input *ngIf="!toggleFilterInputType" type="text"
          class="form-control"
          placeholder="Enter filter value..."
          formControlName="fieldValue">

          <select
          *ngIf="filterRequestsForm.value.field == 'location'"
          formControlName="fieldValue"
          class="form-control">
            <option *ngFor="let location of locations" value="{{ location.name }}">{{ location.name }}</option>
          </select>

          <select
          *ngIf="filterRequestsForm.value.field == 'engineerAssigned'"
          formControlName="fieldValue"
          class="form-control">
            <option *ngFor="let member of groupMembers" value="{{ member.username }}">{{ member.fullName }}</option>
          </select>
          <select
          *ngIf="filterRequestsForm.value.field == 'propertyCode'"
          formControlName="fieldValue"
          class="form-control">
            <option *ngFor="let propCode of propCodes" value="{{ propCode.code }}">{{ propCode.propertyName }}</option>
          </select>
        </div>
      </div>

      <div class="container d-inline-flex">
        <button type="submit" class="btn btn-sm btn-dark m-2">Apply</button>
        <button class="btn btn-sm btn-dark m-2" (click)="clearFilter($event)">Clear</button>
      </div>

    </form>
  </div>

  <table class="table table-hover">
    <thead>
      <tr>
        <th scope="col">View</th>
        <th mat-sort-header="requestID" scope="col">Request ID</th>
        <th mat-sort-header="createdBy" scope="col">Requested By</th>
        <th mat-sort-header="requestDate" scope="col">Request Date</th>
        <th mat-sort-header="location" scope="col">Location</th>
        <th mat-sort-header="status" scope="col">Status</th>
        <th mat-sort-header="approved" scope="col">Approved</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let request of sortedData" class="{{ request.requestDate | requestDeadline }}">
        <td><button class="btn btn-sm btn-dark" [routerLink]="['/request-detail/', request.requestID]">+</button></td>
        <td>{{ request.requestID }}</td>
        <td>{{ request.createdBy }}</td>
        <td>{{ request.requestDate | date }}</td>
        <td>{{ request.location }}</td>
        <td>{{ request.status }}</td>
        <td>{{ request.approved }}</td>
      </tr>
    </tbody>
  </table>



</div>

